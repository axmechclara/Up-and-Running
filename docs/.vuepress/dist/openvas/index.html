<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>OpenVAS Vulnerability Assessment Scanner | Libellux</title>
    <meta name="generator" content="VuePress 1.7.1">
    <link rel="icon" href="https://www.libellux.com/img/icons/72x72.png">
    <link rel="apple-touch-icon" sizes="48x48" href="https://www.libellux.com/img/icons/48x48.png">
    <link rel="apple-touch-icon" sizes="72x72" href="https://www.libellux.com/img/icons/72x72.png">
    <link rel="apple-touch-icon" sizes="144x144" href="https://www.libellux.com/img/icons/144x144.png">
    <link rel="apple-touch-icon" sizes="192x192" href="https://www.libellux.com/img/icons/192x192.png">
    <link rel="apple-touch-icon" sizes="256x256" href="https://www.libellux.com/img/icons/256x256.png">
    <link rel="apple-touch-icon" sizes="384x384" href="https://www.libellux.com/img/icons/384x384.png">
    <link rel="apple-touch-icon" sizes="512x512" href="https://www.libellux.com/img/icons/512x512.png">
    <link rel="apple-touch-icon" sizes="1200x627" href="https://www.libellux.com/img/icons/1200x627.png">
    <script>
    (function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
            new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
        j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
        'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
    })(window,document,'script','dataLayer','GTM-5DHC7KR');
    </script>
    <meta name="description" content="OpenVAS is a full-featured vulnerability scanner. Its capabilities include unauthenticated testing, authenticated testing, various high level and low level Internet and industrial protocols, performance tuning for large-scale scans and a powerful internal programming language to implement any type of vulnerability test.">
    <meta name="robots" content="index, follow">
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:creator" content="@libellux1">
    <meta name="twitter:title" content="Libellux">
    <meta name="twitter:description" content="Libellux Up and Running is a collection of personal notes and documentation regarding open-source software configuration. The focus is to build a so called Zero Trust Network using a central authentication server to enhance the security for our existing applications. We will manage our network using an open-source software tool for provisioning and configuration management to automate and speed up productivity.">
    <meta name="twitter:image" content="https://www.libellux.com/img/icons/4096x4096.png">
    <meta name="twitter:width" content="4096">
    <meta name="twitter:height" content="4096">
    <meta property="og:locale" content="en_US">
    <meta property="og:type" content="website">
    <meta property="og:title" content="Libellux">
    <meta property="og:description" content="Libellux Up and Running is a collection of personal notes and documentation regarding open-source software configuration. The focus is to build a so called Zero Trust Network using a central authentication server to enhance the security for our existing applications. We will manage our network using an open-source software tool for provisioning and configuration management to automate and speed up productivity.">
    <meta property="og:url" content="https://www.libellux.com">
    <meta property="og:site_name" content="Libellux">
    <meta property="og:publisher" content="https://www.facebook.com/libellux1">
    <meta property="og:author" content="https://www.facebook.com/fredrik.hilmersson.1">
    <meta property="og:image" content="https://www.libellux.com/img/icons/1200x627.png">
    <meta property="og:image:width" content="1200">
    <meta property="og:image:height" content="627">
    <meta name="msapplication-TileImage" content="https://www.libellux.com/img/icons/144x144.png">
    <meta name="google-site-verification" content="ETZL1kPGWFR91LmM1H7-ahMFCFKID7P2aXf3k29ISWw">
    
    <link rel="preload" href="/assets/css/0.styles.fec8a880.css" as="style"><link rel="preload" href="/assets/js/app.233fab16.js" as="script"><link rel="preload" href="/assets/js/2.e28a458f.js" as="script"><link rel="preload" href="/assets/js/16.fa8634a1.js" as="script"><link rel="preload" href="/assets/js/7.11d40bb1.js" as="script"><link rel="preload" href="/assets/js/4.197bc1c7.js" as="script"><link rel="preload" href="/assets/js/3.1f33fffe.js" as="script"><link rel="prefetch" href="/assets/js/10.efee864f.js"><link rel="prefetch" href="/assets/js/11.dbbb807f.js"><link rel="prefetch" href="/assets/js/12.ba312fd3.js"><link rel="prefetch" href="/assets/js/13.bae310e7.js"><link rel="prefetch" href="/assets/js/14.8b0ff03b.js"><link rel="prefetch" href="/assets/js/15.e26fd78a.js"><link rel="prefetch" href="/assets/js/17.cd909f53.js"><link rel="prefetch" href="/assets/js/18.3cafeb03.js"><link rel="prefetch" href="/assets/js/19.511bbdc8.js"><link rel="prefetch" href="/assets/js/20.04ce2c17.js"><link rel="prefetch" href="/assets/js/21.cc742de6.js"><link rel="prefetch" href="/assets/js/22.9f1d2525.js"><link rel="prefetch" href="/assets/js/23.c7f38aba.js"><link rel="prefetch" href="/assets/js/24.ef9439f2.js"><link rel="prefetch" href="/assets/js/25.ce4866c2.js"><link rel="prefetch" href="/assets/js/5.e2ac7791.js"><link rel="prefetch" href="/assets/js/6.3b618b4a.js"><link rel="prefetch" href="/assets/js/8.01864534.js"><link rel="prefetch" href="/assets/js/9.6c51ddc2.js">
    <link rel="stylesheet" href="/assets/css/0.styles.fec8a880.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><img src="/img/icons/72x72.png" alt="Libellux" class="logo"> <span class="site-name can-hide">Libellux</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">
  Libellux: Up and Running
</a></div> <a href="https://github.com/libellux/Libellux-Up-and-Running" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">
  Libellux: Up and Running
</a></div> <a href="https://github.com/libellux/Libellux-Up-and-Running" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>Libellux: Up and Running</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/" aria-current="page" class="sidebar-link">Introduction</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>Zero Trust Network</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/wireguard/" class="sidebar-link">WireGuard Secure VPN Tunnel</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>Intrusion Detection and Prevention</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/ossec/" class="sidebar-link">OSSEC Host Intrusion Detection</a></li><li><a href="/psad/" class="sidebar-link">PSAD Intrusion Detection</a></li><li><a href="/openvas/" aria-current="page" class="active sidebar-link">OpenVAS Vulnerability Scanner</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/openvas/#configuration-files" class="sidebar-link">Configuration files</a></li><li class="sidebar-sub-header"><a href="/openvas/#prerequisites" class="sidebar-link">Prerequisites</a></li><li class="sidebar-sub-header"><a href="/openvas/#install-openvas-20-08-from-source" class="sidebar-link">Install OpenVAS 20.08 from source</a></li><li class="sidebar-sub-header"><a href="/openvas/#install-openvas-20-08-centos" class="sidebar-link">Install OpenVAS 20.08 CentOS</a></li><li class="sidebar-sub-header"><a href="/openvas/#running-vulnerability-scans" class="sidebar-link">Running vulnerability scans</a></li><li class="sidebar-sub-header"><a href="/openvas/#install-openvas-9-community-version" class="sidebar-link">Install OpenVAS-9 community version</a></li><li class="sidebar-sub-header"><a href="/openvas/#openvas-behind-nginx-proxy" class="sidebar-link">OpenVAS behind NGINX Proxy</a></li><li class="sidebar-sub-header"><a href="/openvas/#scheduled-jobs" class="sidebar-link">Scheduled jobs</a></li><li class="sidebar-sub-header"><a href="/openvas/#troubleshooting" class="sidebar-link">Troubleshooting</a></li><li class="sidebar-sub-header"><a href="/openvas/#enterprise-solutions" class="sidebar-link">Enterprise solutions</a></li></ul></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>Monitoring and Management</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/mmonit/" class="sidebar-link">M/Monit System Monitoring</a></li><li><a href="/pcp/" class="sidebar-link">Performance Co-Pilot Grafana</a></li><li><a href="/graylog/" class="sidebar-link">Graylog Centralized Log Management</a></li><li><a href="/rsyslog/" class="sidebar-link">Rsyslog Log Processing</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>Miscellaneous</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/jira/" class="sidebar-link">Jira Software</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="openvas-vulnerability-assessment-scanner"><a href="#openvas-vulnerability-assessment-scanner" class="header-anchor">#</a> OpenVAS Vulnerability Assessment Scanner</h1> <div>
  Tags:
  <a href="/tags.html#vulnerability">
    vulnerability
  </a><a href="/tags.html#scanner">
    scanner
  </a><a href="/tags.html#security">
    security
  </a></div> <p>OpenVAS is a full-featured vulnerability scanner. Its capabilities include unauthenticated testing, authenticated testing, various high level and low level Internet and industrial protocols, performance tuning for large-scale scans and a powerful internal programming language to implement any type of vulnerability test.</p> <p><a href="https://www.openvas.org/" target="_blank" rel="noopener noreferrer">OpenVAS website<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> <a href="https://github.com/greenbone/openvas" target="_blank" rel="noopener noreferrer">GitHub<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p>Setup and configuration has been tested on the following operating systems:</p> <ul><li>Ubuntu- 16.04, 18.04, 20.04, CentOS 8</li> <li>OpenVAS 20.08 for Debian 10 visit <a href="https://sadsloth.net/post/install-gvm-20_08-src-on-debian/" target="_blank" rel="noopener noreferrer">sadsloth.net<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>.</li> <li>GVM-9 (OpenVAS-9), GVM-20.08 (OpenVAS 20.08), Atomicorp 20.08 (RHEL 8, CentOS 8, Fedora 32)</li></ul> <div class="custom-block warning"><p class="custom-block-title">NOTE</p> <p>GVM-9 (OpenVAS-9) reached end-of-life support. GVM 10 and 11 will reach end-of-life support in the end of 2020.</p></div> <h2 id="configuration-files"><a href="#configuration-files" class="header-anchor">#</a> Configuration files</h2> <h2 id="prerequisites"><a href="#prerequisites" class="header-anchor">#</a> Prerequisites</h2> <p>Dependencies required to install OpenVAS 20.08 from source on Ubuntu 20.04:</p> <ul><li><code>build-essential</code></li> <li><code>cmake</code></li> <li><code>gnutls-bin</code></li> <li><code>pkg-config</code></li> <li><code>glib2.0</code></li> <li><code>libgnutls28-dev</code></li> <li><code>libssh-dev</code></li> <li><code>libssl-dev</code></li> <li><code>libhiredis-dev</code></li> <li><code>redis-server</code></li> <li><code>libxml2-dev</code></li> <li><code>doxygen</code></li> <li><code>xsltproc</code></li> <li><code>libldap2-dev</code></li> <li><code>libgcrypt-dev</code></li> <li><code>libpcap-dev</code></li> <li><code>libgpgme-dev</code></li> <li><code>libradcli-dev</code></li> <li><code>graphviz</code></li> <li><code>bison</code></li> <li><code>libksba-dev</code></li> <li><code>libical-dev</code></li> <li><code>libpq-dev</code></li> <li><code>postgresql</code></li> <li><code>postgresql-contrib</code></li> <li><code>postgresql-server-dev-all</code></li> <li><code>libopenvas-dev</code></li> <li><code>heimdal-dev</code></li> <li><code>libpopt-dev</code></li> <li><code>xmltoman</code></li> <li><code>gcc-mingw-w64</code></li> <li><code>nmap</code></li> <li><code>npm</code></li> <li><code>nodejs</code></li> <li><code>libpthread-stubs0-dev</code></li> <li><code>clang-format</code></li> <li><code>libmicrohttpd-dev</code></li> <li><code>yarn</code></li> <li><code>virtualenv</code></li> <li><code>python3-paramiko</code></li> <li><code>python3-lxml</code></li> <li><code>python3-defusedxml</code></li> <li><code>python3-pip</code></li> <li><code>python3-psutil</code></li></ul> <h2 id="install-openvas-20-08-from-source"><a href="#install-openvas-20-08-from-source" class="header-anchor">#</a> Install OpenVAS 20.08 from source <span class="badge default" style="vertical-align:top;" data-v-15b7b770>Rev 3</span></h2> <p>To install OpenVAS 20.08 on Ubuntu 20.04 (GVM 20.08) first download all the dependencies.</p> <div class="language- extra-class"><pre class="language-text"><code>server@ubuntu:~$ sudo apt-get install build-essential cmake gnutls-bin pkg-config glib2.0 libgnutls28-dev libssh-dev libssl-dev redis-server libhiredis-dev libxml2-dev doxygen xsltproc libldap2-dev libgcrypt-dev libpcap-dev libgpgme-dev libradcli-dev graphviz bison libksba-dev libical-dev libpq-dev postgresql postgresql-contrib postgresql-server-dev-all libopenvas-dev heimdal-dev libpopt-dev xmltoman gcc-mingw-w64 nmap libmicrohttpd-dev npm nodejs virtualenv python3-paramiko python3-lxml python3-defusedxml python3-pip python3-psutil
</code></pre></div><p>Continue to install yarn using npm with the specified installation path.</p> <div class="language- extra-class"><pre class="language-text"><code>server@ubuntu:~$ sudo npm install -g yarn --prefix /usr/
</code></pre></div><h3 id="set-up-gvm-user-profile"><a href="#set-up-gvm-user-profile" class="header-anchor">#</a> Set up GVM user profile</h3> <p>Create the profile for the GVM (Greenbone Vulnerability Manager) user and set the export path.</p> <div class="language- extra-class"><pre class="language-text"><code>server@ubuntu:~$ echo 'export PATH=&quot;$PATH:/opt/gvm/bin:/opt/gvm/sbin:/opt/gvm/.local/bin&quot;' | sudo tee -a /etc/profile.d/gvm.sh
server@ubuntu:~$ sudo chmod 0755 /etc/profile.d/gvm.sh
server@ubuntu:~$ source /etc/profile.d/gvm.sh
</code></pre></div><h3 id="create-dynamic-loader-configuration-file"><a href="#create-dynamic-loader-configuration-file" class="header-anchor">#</a> Create dynamic loader configuration file</h3> <p>Now create the <code>gvm.conf</code> for the dynamic loader and define the gvm-libs path.</p> <div class="language- extra-class"><pre class="language-text"><code>server@ubuntu:~$ sudo nano /etc/ld.so.conf.d/gvm.conf
# gmv-libs location
/opt/gvm/lib
</code></pre></div><h3 id="create-the-gvm-user"><a href="#create-the-gvm-user" class="header-anchor">#</a> Create the GVM user</h3> <p>Once saved, proceed to create and configure the GVM user.</p> <div class="language- extra-class"><pre class="language-text"><code>server@ubuntu:~$ sudo mkdir /opt/gvm
server@ubuntu:~$ sudo adduser gvm --disabled-password --home /opt/gvm/ --no-create-home --gecos ''
server@ubuntu:~$ sudo usermod -aG redis gvm
server@ubuntu:~$ sudo chown gvm:gvm /opt/gvm/
server@ubuntu:~$ sudo su - gvm
</code></pre></div><h3 id="create-source-build-directory"><a href="#create-source-build-directory" class="header-anchor">#</a> Create source build directory</h3> <p>Run the command <code>pwd</code> and you should now be in the <code>/opt/gvm/</code> directory. Create the source directory, where we will download and build all required packages and set the package configuration path.</p> <div class="language- extra-class"><pre class="language-text"><code>gvm@ubuntu:~$ mkdir src
gvm@ubuntu:~$ cd src/
gvm@ubuntu:~$ export PKG_CONFIG_PATH=/opt/gvm/lib/pkgconfig:$PKG_CONFIG_PATH
</code></pre></div><h3 id="build-gvm-libraries"><a href="#build-gvm-libraries" class="header-anchor">#</a> Build GVM Libraries</h3> <p>Download and build the <a href="https://github.com/greenbone/gvm-libs" target="_blank" rel="noopener noreferrer">GVM Libraries<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> version 20.08.</p> <div class="language- extra-class"><pre class="language-text"><code>gvm@ubuntu:~$ git clone -b gvm-libs-20.08 --single-branch https://github.com/greenbone/gvm-libs.git
gvm@ubuntu:~$ cd gvm-libs/
gvm@ubuntu:~$ export PKG_CONFIG_PATH=/opt/gvm/lib/pkgconfig:$PKG_CONFIG_PATH
gvm@ubuntu:~$ mkdir build
gvm@ubuntu:~$ cd build
gvm@ubuntu:~$ cmake -DCMAKE_INSTALL_PREFIX=/opt/gvm ..
gvm@ubuntu:~$ make
gvm@ubuntu:~$ make doc
gvm@ubuntu:~$ make install
gvm@ubuntu:~$ cd /opt/gvm/src/
</code></pre></div><h3 id="build-openvas-samba-package"><a href="#build-openvas-samba-package" class="header-anchor">#</a> Build OpenVAS Samba package</h3> <p>Download and build the <a href="https://github.com/greenbone/openvas-smb" target="_blank" rel="noopener noreferrer">OpenVAS Samba package for Windows usage<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>.</p> <div class="language- extra-class"><pre class="language-text"><code>gvm@ubuntu:~$ git clone -b master --single-branch https://github.com/greenbone/openvas-smb.git
gvm@ubuntu:~$ cd openvas-smb/
gvm@ubuntu:~$ export PKG_CONFIG_PATH=/opt/gvm/lib/pkgconfig:$PKG_CONFIG_PATH
gvm@ubuntu:~$ mkdir build
gvm@ubuntu:~$ cd build/
gvm@ubuntu:~$ cmake -DCMAKE_INSTALL_PREFIX=/opt/gvm ..
gvm@ubuntu:~$ make install
gvm@ubuntu:~$ cd /opt/gvm/src/
</code></pre></div><h3 id="build-the-openvas-scanner"><a href="#build-the-openvas-scanner" class="header-anchor">#</a> Build the OpenVAS Scanner</h3> <p>Download and build the <a href="https://github.com/greenbone/openvas" target="_blank" rel="noopener noreferrer">openvas-scanner (OpenVAS)<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> version 20.08.</p> <div class="language- extra-class"><pre class="language-text"><code>gvm@ubuntu:~$ git clone -b openvas-20.08 --single-branch https://github.com/greenbone/openvas.git
gvm@ubuntu:~$ cd openvas/
gvm@ubuntu:~$ export PKG_CONFIG_PATH=/opt/gvm/lib/pkgconfig:$PKG_CONFIG_PATH
gvm@ubuntu:~$ mkdir build
gvm@ubuntu:~$ cd build/
gvm@ubuntu:~$ cmake -DCMAKE_INSTALL_PREFIX=/opt/gvm ..
gvm@ubuntu:~$ make
gvm@ubuntu:~$ make doc
gvm@ubuntu:~$ make install
gvm@ubuntu:~$ exit
</code></pre></div><h3 id="configure-redis"><a href="#configure-redis" class="header-anchor">#</a> Configure Redis</h3> <p>Next configure redis for the default OpenVAS installation.</p> <div class="language- extra-class"><pre class="language-text"><code>server@ubuntu:~$ sudo su
root@ubuntu:~$ export LC_ALL=&quot;C&quot;
root@ubuntu:~$ ldconfig
root@ubuntu:~$ cp /etc/redis/redis.conf /etc/redis/redis.orig
root@ubuntu:~$ cp /opt/gvm/src/openvas/config/redis-openvas.conf /etc/redis/
root@ubuntu:~$ chown redis:redis /etc/redis/redis-openvas.conf
root@ubuntu:~$ echo &quot;db_address = /run/redis-openvas/redis.sock&quot; &gt; /opt/gvm/etc/openvas/openvas.conf
root@ubuntu:~$ systemctl enable redis-server@openvas.service
root@ubuntu:~$ systemctl start redis-server@openvas.service
</code></pre></div><h3 id="set-up-gvm-user-permissions"><a href="#set-up-gvm-user-permissions" class="header-anchor">#</a> Set up GVM user permissions</h3> <p>OpenVAS will be launched from an ospd-openvas process. The process need to be executed using sudo. Update the secure path in the sudoers file accordingly.</p> <div class="language- extra-class"><div class="highlight-lines"><br><br><br><br><br><br><br><br><br><br><br><div class="highlighted"> </div><br></div><pre class="language-text"><code>root@ubuntu:~$ visudo
#
# This file MUST be edited with the 'visudo' command as root.
#
# Please consider adding local content in /etc/sudoers.d/ instead of
# directly modifying this file.
#
# See the man page for details on how to write a sudoers file.
#
Defaults        env_reset
Defaults        mail_badpass
Defaults        secure_path=&quot;/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/snap/bin:/opt/gvm/sbin&quot;
</code></pre></div><p>Additionally in the sudoers file add the following lines to give the GVM user privileges to execute OpenVAS and the greenbone security assistant (gsad) without password.</p> <div class="language- extra-class"><div class="highlight-lines"><br><br><br><br><div class="highlighted"> </div><div class="highlighted"> </div><br></div><pre class="language-text"><code># Allow members of group sudo to execute any command
%sudo   ALL=(ALL:ALL) ALL

### Allow gvm user to run ospd-openvas and launch OpenVAS with root privileges
gvm ALL = NOPASSWD: /opt/gvm/sbin/openvas
gvm ALL = NOPASSWD: /opt/gvm/sbin/gsad
</code></pre></div><h3 id="update-network-vulnerability-tests"><a href="#update-network-vulnerability-tests" class="header-anchor">#</a> Update Network Vulnerability Tests</h3> <p>Once the updated sudoers file is saved, update Network Vulnerability Tests (NVT) from Greenbone Community Feed (this might take awhile).</p> <div class="language- extra-class"><div class="highlight-lines"><br><br><div class="highlighted"> </div><br></div><pre class="language-text"><code>root@ubuntu:~$ exit
server@ubuntu:~$ sudo su - gvm
gvm@ubuntu:~$ greenbone-nvt-sync
</code></pre></div><h3 id="build-the-greenbone-vulnerability-manager"><a href="#build-the-greenbone-vulnerability-manager" class="header-anchor">#</a> Build the Greenbone Vulnerability Manager</h3> <p>Next download and build the <a href="https://github.com/greenbone/gvmd" target="_blank" rel="noopener noreferrer">Greenbone Vulnerability Manager (GVM)<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> version 20.08</p> <div class="language- extra-class"><pre class="language-text"><code>gvm@ubuntu:~$ cd /opt/gvm/src/
gvm@ubuntu:~$ git clone -b gvmd-20.08 --single-branch https://github.com/greenbone/gvmd.git
gvm@ubuntu:~$ cd gvmd/
gvm@ubuntu:~$ export PKG_CONFIG_PATH=/opt/gvm/lib/pkgconfig:$PKG_CONFIG_PATH
gvm@ubuntu:~$ mkdir build
gvm@ubuntu:~$ cd build/
gvm@ubuntu:~$ cmake -DCMAKE_INSTALL_PREFIX=/opt/gvm ..
gvm@ubuntu:~$ make
gvm@ubuntu:~$ make doc
gvm@ubuntu:~$ make install
gvm@ubuntu:~$ exit
</code></pre></div><h3 id="configure-postgresql-database"><a href="#configure-postgresql-database" class="header-anchor">#</a> Configure PostgreSQL database</h3> <p>For additional information see reference greenbone/gvmd <a href="https://github.com/greenbone/gvmd/blob/master/INSTALL.md" target="_blank" rel="noopener noreferrer">INSTALL.md<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>.</p> <p>First make sure that the required dependencies have been installed (see <a href="#prerequisites">Prerequisites</a>). Proceed to create a Postgres user and database.</p> <div class="language- extra-class"><pre class="language-text"><code>server@ubuntu:~$ sudo -u postgres bash
postgres@ubuntu:/home/server$ export LC_ALL=&quot;C&quot;
postgres@ubuntu:/home/server$ createuser -DRS gvm
postgres@ubuntu:/home/server$ createdb -O gvm gvmd
</code></pre></div><p>Setup correct permissions.</p> <div class="language- extra-class"><pre class="language-text"><code>postgres@ubuntu:/home/server$ psql gvmd
gvmd=# create role dba with superuser noinherit;
gvmd=# grant dba to gvm;
</code></pre></div><p>Create database extensions.</p> <div class="language- extra-class"><pre class="language-text"><code>gvmd=# create extension &quot;uuid-ossp&quot;;
gvmd=# create extension &quot;pgcrypto&quot;;
gvmd=# exit
postgres@ubuntu:/home/server$ exit
</code></pre></div><h3 id="generate-gvm-certificates"><a href="#generate-gvm-certificates" class="header-anchor">#</a> Generate GVM certificates</h3> <p>Once the database has been configured proceed and create the certificates.</p> <div class="language- extra-class"><div class="highlight-lines"><br><div class="highlighted"> </div><br></div><pre class="language-text"><code>server@ubuntu:~$ sudo su - gvm
gvm@ubuntu:~$ gvm-manage-certs -a
</code></pre></div><h3 id="create-gvm-admin"><a href="#create-gvm-admin" class="header-anchor">#</a> Create GVM admin</h3> <p>Create the gvm administration user. Do not forget to change the password later.</p> <div class="custom-block warning"><p class="custom-block-title">NOTE</p> <p>Do not use special characters in the password.</p></div> <div class="language- extra-class"><pre class="language-text"><code>gvm@ubuntu:~$ /opt/gvm/sbin/gvmd --create-user=admin --password=admin
User created.
</code></pre></div><p>Next, lets retrieve our administrators uuid.</p> <div class="language- extra-class"><div class="highlight-lines"><br><div class="highlighted"> </div><br></div><pre class="language-text"><code>gvm@ubuntu:~$ gvmd --get-users --verbose
gvm@ubuntu:~$ admin 129a1661-138b-4017-25x1-xc0231f91222
</code></pre></div><p>Use the administration uuid and modify the gvmd settings as written below.</p> <div class="language- extra-class"><pre class="language-text"><code>gvm@ubuntu:~$ gvmd --modify-setting 78eceaec-3385-11ea-b237-28d24461215b --value 129a1661-138b-4017-25x1-xc0231f91222
</code></pre></div><h3 id="update-greenbone-feed-sync"><a href="#update-greenbone-feed-sync" class="header-anchor">#</a> Update Greenbone Feed Sync</h3> <p>Update the Greenbone Feed Synchronisation one at the time (this might take awhile).</p> <div class="language- extra-class"><pre class="language-text"><code>gvm@ubuntu:~$ greenbone-feed-sync --type GVMD_DATA
gvm@ubuntu:~$ greenbone-feed-sync --type SCAP
gvm@ubuntu:~$ greenbone-feed-sync --type CERT
</code></pre></div><h3 id="build-the-greenbone-security-assistant"><a href="#build-the-greenbone-security-assistant" class="header-anchor">#</a> Build the Greenbone Security Assistant</h3> <p>Proceed to download and build the <a href="https://github.com/greenbone/gsa" target="_blank" rel="noopener noreferrer">Greenbone Security Assistant (GSA)<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> version 20.08.</p> <div class="language- extra-class"><pre class="language-text"><code>gvm@ubuntu:~$ cd src/
gvm@ubuntu:~$ git clone -b gsa-20.08 --single-branch https://github.com/greenbone/gsa.git
gvm@ubuntu:~$ cd gsa/
gvm@ubuntu:~$ export PKG_CONFIG_PATH=/opt/gvm/lib/pkgconfig:$PKG_CONFIG_PATH
gvm@ubuntu:~$ mkdir build
gvm@ubuntu:~$ cd build/
gvm@ubuntu:~$ cmake -DCMAKE_INSTALL_PREFIX=/opt/gvm ..
gvm@ubuntu:~$ make
gvm@ubuntu:~$ make doc
gvm@ubuntu:~$ make install
gvm@ubuntu:~$ touch /opt/gvm/var/log/gvm/gsad.log
</code></pre></div><h3 id="set-up-the-virtual-environment-with-python"><a href="#set-up-the-virtual-environment-with-python" class="header-anchor">#</a> Set up the Virtual environment with Python</h3> <p>First check the version of Python. If the version is not 3.7, add the repository and install the required version.</p> <div class="language- extra-class"><pre class="language-text"><code>gvm@ubuntu:~$ exit
server@ubuntu:~$ python3 --version
server@ubuntu:~$ sudo add-apt-repository ppa:deadsnakes/ppa
server@ubuntu:~$ sudo apt-get update
server@ubuntu:~$ sudo apt-get install python3.7 python3.7-dev
</code></pre></div><p>Next install the virtual environment.</p> <div class="language- extra-class"><pre class="language-text"><code>server@ubuntu:~$ sudo su - gvm
gvm@ubuntu:~$ cd /opt/gvm/src
gvm@ubuntu:~$ export PKG_CONFIG_PATH=/opt/gvm/lib/pkgconfig:$PKG_CONFIG_PATH
gvm@ubuntu:~$ virtualenv --python python3.7  /opt/gvm/bin/ospd-scanner/
(ospd-scanner) gvm@ubuntu:~$ source /opt/gvm/bin/ospd-scanner/bin/activate
</code></pre></div><h3 id="download-and-install-the-base-class-ospd-for-scanner-wrappers"><a href="#download-and-install-the-base-class-ospd-for-scanner-wrappers" class="header-anchor">#</a> Download and install the base class ospd for scanner wrappers</h3> <p>Proceed to download and install <a href="https://github.com/greenbone/ospd" target="_blank" rel="noopener noreferrer">ospd<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>.</p> <div class="language- extra-class"><pre class="language-text"><code>(ospd-scanner) gvm@ubuntu:~$ git clone -b ospd-20.08 --single-branch https://github.com/greenbone/ospd.git
(ospd-scanner) gvm@ubuntu:~$ mkdir /opt/gvm/var/run/ospd/
(ospd-scanner) gvm@ubuntu:~$ cd ospd/
(ospd-scanner) gvm@ubuntu:~$ pip3 install .
(ospd-scanner) gvm@ubuntu:~$ cd /opt/gvm/src
</code></pre></div><h3 id="download-and-install-ospd-openvas-for-remote-control"><a href="#download-and-install-ospd-openvas-for-remote-control" class="header-anchor">#</a> Download and install ospd-openvas for remote control</h3> <p>Install the <a href="https://github.com/greenbone/ospd-openvas" target="_blank" rel="noopener noreferrer">ospd-openvas<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> for remote access.</p> <div class="language- extra-class"><pre class="language-text"><code>(ospd-scanner) gvm@ubuntu:~$ git clone -b ospd-openvas-20.08 --single-branch  https://github.com/greenbone/ospd-openvas.git
(ospd-scanner) gvm@ubuntu:~$ cd ospd-openvas/
(ospd-scanner) gvm@ubuntu:~$ pip3 install .
</code></pre></div><h3 id="set-up-systemd"><a href="#set-up-systemd" class="header-anchor">#</a> Set up systemd</h3> <p>Next setup the startup scripts. First, configure the Greenbone Manager startup script.</p> <div class="language- extra-class"><pre class="language-text"><code>gvm@ubuntu:~$ exit
server@ubuntu:~$ sudo su
root@ubuntu:~$ nano /etc/systemd/system/gvmd.service
</code></pre></div><p>Paste the following settings to the startup script.</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token punctuation">[</span>Unit<span class="token punctuation">]</span>
<span class="token assign-left variable">Description</span><span class="token operator">=</span>Open Vulnerability Assessment System Manager Daemon
<span class="token assign-left variable">Documentation</span><span class="token operator">=</span>man:gvmd<span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">)</span> https://www.greenbone.net
<span class="token assign-left variable">Wants</span><span class="token operator">=</span>postgresql.service ospd-openvas.service
<span class="token assign-left variable">After</span><span class="token operator">=</span>postgresql.service ospd-openvas.service

<span class="token punctuation">[</span>Service<span class="token punctuation">]</span>
<span class="token assign-left variable">Type</span><span class="token operator">=</span>forking
<span class="token assign-left variable">User</span><span class="token operator">=</span>gvm
<span class="token assign-left variable">Group</span><span class="token operator">=</span>gvm
<span class="token assign-left variable">PIDFile</span><span class="token operator">=</span>/opt/gvm/var/run/gvmd.pid
<span class="token assign-left variable">WorkingDirectory</span><span class="token operator">=</span>/opt/gvm
<span class="token assign-left variable">ExecStart</span><span class="token operator">=</span>/opt/gvm/sbin/gvmd --osp-vt-update<span class="token operator">=</span>/opt/gvm/var/run/ospd.sock
<span class="token assign-left variable">ExecReload</span><span class="token operator">=</span>/bin/kill -HUP <span class="token variable">$MAINPID</span>
<span class="token assign-left variable">KillMode</span><span class="token operator">=</span>mixed
<span class="token assign-left variable">Restart</span><span class="token operator">=</span>on-failure
<span class="token assign-left variable">RestartSec</span><span class="token operator">=</span>2min
<span class="token assign-left variable">KillMode</span><span class="token operator">=</span>process
<span class="token assign-left variable">KillSignal</span><span class="token operator">=</span>SIGINT
<span class="token assign-left variable">GuessMainPID</span><span class="token operator">=</span>no
<span class="token assign-left variable">PrivateTmp</span><span class="token operator">=</span>true

<span class="token punctuation">[</span>Install<span class="token punctuation">]</span>
<span class="token assign-left variable">WantedBy</span><span class="token operator">=</span>multi-user.target
</code></pre></div><p>Once the first startup script is saved, proceed to create the script for the Greenbone Security Assistant (GSA).</p> <div class="language- extra-class"><pre class="language-text"><code>root@ubuntu:~$ nano /etc/systemd/system/gsad.service
</code></pre></div><p>Paste the following setup to the GSA startup script.</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token punctuation">[</span>Unit<span class="token punctuation">]</span>
<span class="token assign-left variable">Description</span><span class="token operator">=</span>Greenbone Security Assistant <span class="token punctuation">(</span>gsad<span class="token punctuation">)</span>
<span class="token assign-left variable">Documentation</span><span class="token operator">=</span>man:gsad<span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">)</span> https://www.greenbone.net
<span class="token assign-left variable">After</span><span class="token operator">=</span>network.target
<span class="token assign-left variable">Wants</span><span class="token operator">=</span>gvmd.service

<span class="token punctuation">[</span>Service<span class="token punctuation">]</span>
<span class="token assign-left variable">Type</span><span class="token operator">=</span>forking
<span class="token assign-left variable">PIDFile</span><span class="token operator">=</span>/opt/gvm/var/run/gsad.pid
<span class="token assign-left variable">WorkingDirectory</span><span class="token operator">=</span>/opt/gvm
<span class="token assign-left variable">ExecStart</span><span class="token operator">=</span>/opt/gvm/sbin/gsad --drop-privileges<span class="token operator">=</span>gvm
<span class="token assign-left variable">Restart</span><span class="token operator">=</span>on-failure
<span class="token assign-left variable">RestartSec</span><span class="token operator">=</span>2min
<span class="token assign-left variable">KillMode</span><span class="token operator">=</span>process
<span class="token assign-left variable">KillSignal</span><span class="token operator">=</span>SIGINT
<span class="token assign-left variable">GuessMainPID</span><span class="token operator">=</span>no
<span class="token assign-left variable">PrivateTmp</span><span class="token operator">=</span>true

<span class="token punctuation">[</span>Install<span class="token punctuation">]</span>
<span class="token assign-left variable">WantedBy</span><span class="token operator">=</span>multi-user.target
</code></pre></div><p>Create the systemd service script for ospd-openvas.</p> <div class="language- extra-class"><pre class="language-text"><code>root@ubuntu:~$ nano /etc/systemd/system/ospd-openvas.service
</code></pre></div><p>Paste the following settings to the ospd-openvas startup script.</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token punctuation">[</span>Unit<span class="token punctuation">]</span>
<span class="token assign-left variable">Description</span><span class="token operator">=</span>Job that runs the ospd-openvas daemon
<span class="token assign-left variable">Documentation</span><span class="token operator">=</span>man:gvm
<span class="token assign-left variable">After</span><span class="token operator">=</span>network.target redis-server@openvas.service
<span class="token assign-left variable">Wants</span><span class="token operator">=</span>redis-server@openvas.service

<span class="token punctuation">[</span>Service<span class="token punctuation">]</span>
<span class="token assign-left variable">Environment</span><span class="token operator">=</span><span class="token environment constant">PATH</span><span class="token operator">=</span>/opt/gvm/bin/ospd-scanner/bin:/opt/gvm/bin:/opt/gvm/sbin:/opt/gvm/.local/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin
<span class="token assign-left variable">Type</span><span class="token operator">=</span>forking
<span class="token assign-left variable">User</span><span class="token operator">=</span>gvm
<span class="token assign-left variable">Group</span><span class="token operator">=</span>gvm
<span class="token assign-left variable">WorkingDirectory</span><span class="token operator">=</span>/opt/gvm
<span class="token assign-left variable">PIDFile</span><span class="token operator">=</span>/opt/gvm/var/run/ospd-openvas.pid
<span class="token assign-left variable">ExecStart</span><span class="token operator">=</span>/opt/gvm/bin/ospd-scanner/bin/python /opt/gvm/bin/ospd-scanner/bin/ospd-openvas --pid-file /opt/gvm/var/run/ospd-openvas.pid --unix-socket<span class="token operator">=</span>/opt/gvm/var/run/ospd.sock --log-file /opt/gvm/var/log/gvm/ospd-scanner.log --lock-file-dir /opt/gvm/var/run/ospd/
<span class="token assign-left variable">Restart</span><span class="token operator">=</span>on-failure
<span class="token assign-left variable">RestartSec</span><span class="token operator">=</span>2min
<span class="token assign-left variable">KillMode</span><span class="token operator">=</span>process
<span class="token assign-left variable">KillSignal</span><span class="token operator">=</span>SIGINT
<span class="token assign-left variable">GuessMainPID</span><span class="token operator">=</span>no
<span class="token assign-left variable">PrivateTmp</span><span class="token operator">=</span>true

<span class="token punctuation">[</span>Install<span class="token punctuation">]</span>
<span class="token assign-left variable">WantedBy</span><span class="token operator">=</span>multi-user.target
</code></pre></div><p>Reload the system daemon and enable the startup script.</p> <div class="language- extra-class"><pre class="language-text"><code>root@ubuntu:~$ systemctl daemon-reload
root@ubuntu:~$ systemctl enable gvmd
root@ubuntu:~$ systemctl enable gsad
root@ubuntu:~$ systemctl enable ospd-openvas
root@ubuntu:~$ systemctl start gvmd
root@ubuntu:~$ systemctl start gsad
root@ubuntu:~$ systemctl start ospd-openvas
</code></pre></div><p>Next check that all the services are running.</p> <div class="language- extra-class"><div class="highlight-lines"><div class="highlighted"> </div><br><br><br><div class="highlighted"> </div><br><br><br><div class="highlighted"> </div><br><br><br><br></div><pre class="language-text"><code>root@ubuntu:~$ systemctl status gvmd
● gvmd.service - Open Vulnerability Assessment System Manager Daemon
     Loaded: loaded (/etc/systemd/system/gvmd.service; enabled; vendor preset: enabled)
     Active: active (running) since Tue 2020-09-29 21:04:47 UTC; 15s ago
root@ubuntu:~$ systemctl status gsad
● gsad.service - Greenbone Security Assistant (gsad)
     Loaded: loaded (/etc/systemd/system/gsad.service; enabled; vendor preset: enabled)
     Active: active (running) since Tue 2020-09-29 21:04:51 UTC; 28s ago
root@ubuntu:~$ systemctl status ospd-openvas
● ospd-openvas.service - Job that runs the ospd-openvas daemon
     Loaded: loaded (/etc/systemd/system/ospd-openvas.service; enabled; vendor preset: enabled)
     Active: active (running) since Tue 2020-09-29 21:04:45 UTC; 48s ago
</code></pre></div><p>Login at your localhost e.g. <code>https://192.168.0.1</code> with the username <code>admin</code> and the chosen password.</p> <img src="/img/openvas/gsa_login.png" alt="GSA login" class="zoom-custom-imgs"> <p>Once logged in, go to the <em>Administration</em> tab and select <em>Feed Status</em>. You'll see that the update is in progress (this might take awhile). When the status changed to <em>current</em>, go to the dashboard and it will be populated with CVEs by creation time and NVTs by severity class.</p> <img src="/img/openvas/gsa_dashboard.png" alt="GSA dashboard" class="zoom-custom-imgs"> <h3 id="modify-scanner"><a href="#modify-scanner" class="header-anchor">#</a> Modify scanner</h3> <p>Before running vulnerability scans, also known as tasks, you need to modify the default OpenVAS scanner. Start with switching to your gvm user.</p> <div class="language- extra-class"><pre class="language-text"><code>server@ubuntu:~$ sudo su - gvm
</code></pre></div><p>Next get the pre-exisiting scanners by running command below. Copy the UUID from the OpenVAS Default Scanner.</p> <div class="language- extra-class"><div class="highlight-lines"><br><br><div class="highlighted"> </div><br><br></div><pre class="language-text"><code>gvm@ubuntu:~$ cd /opt/gvm/src/
gvm@ubuntu:~$ gvmd --get-scanners
08b69003-5fc2-4037-a479-93b440211c73  OpenVAS  /var/run/ospd/ospd.sock  0  OpenVAS Default
6acd0832-df90-11e4-b9d5-28d24461215b  CVE    0  CVE
</code></pre></div><p>Next run the modification command and attach the UUID to the scanner host socket.</p> <div class="language- extra-class"><div class="highlight-lines"><div class="highlighted"> </div><br><br></div><pre class="language-text"><code>gvm@ubuntu:~$ gvmd --modify-scanner=08b69003-5fc2-4037-a479-93b440211c73 --scanner-host=/opt/gvm/var/run/ospd.sock
Scanner modified.
</code></pre></div><p>To run basic vulnerability scans and get hands-on approach to get started with OpenVAS check the <a href="#running-vulnerability-scans">Running vulnerability scans</a> section.</p> <h2 id="install-openvas-20-08-centos"><a href="#install-openvas-20-08-centos" class="header-anchor">#</a> Install OpenVAS 20.08 CentOS</h2> <p><a href="https://github.com/Atomicorp/openvas" target="_blank" rel="noopener noreferrer">Atomicorp OpenVAS package<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> <span class="badge default" style="vertical-align:top;" data-v-15b7b770>non-sponsored</span></p> <p>Check if SELinux is enabled.</p> <div class="language- extra-class"><div class="highlight-lines"><br><div class="highlighted"> </div><br><br><br><br><div class="highlighted"> </div><br></div><pre class="language-text"><code>server@centos:~$ sestatus
SELinux status:                 enabled
SELinuxfs mount:                /sys/fs/selinux
SELinux root directory:         /etc/selinux
Loaded policy name:             targeted
Current mode:                   enforcing
Mode from config file:          enforcing
</code></pre></div><p>If enabled proceed to disable SELinux by running the command below and update the SELinux configuration file.</p> <div class="language- extra-class"><div class="highlight-lines"><div class="highlighted"> </div><br><br><br><br><br><br><br><div class="highlighted"> </div><br></div><pre class="language-text"><code>server@centos:~$ sudo setenforce 0
server@centos:~$ sudo nano /etc/selinux/config

# This file controls the state of SELinux on the system.
# SELINUX= can take one of these three values:
#     enforcing - SELinux security policy is enforced.
#     permissive - SELinux prints warnings instead of enforcing.
#     disabled - No SELinux policy is loaded.
SELINUX=disabled
</code></pre></div><p>Save and reboot the system.</p> <div class="language- extra-class"><pre class="language-text"><code>server@centos:~$ sudo shutdown -r now
</code></pre></div><p>Once the system rebooted control that SELinux been disabled.</p> <div class="language- extra-class"><pre class="language-text"><code>server@centos:~$ sestatus
SELinux status:                 disabled
</code></pre></div><p>Continue and download the Atomicorp installer.</p> <div class="language- extra-class"><div class="highlight-lines"><br><br><br><br><br><br><div class="highlighted"> </div><div class="highlighted"> </div><br></div><pre class="language-text"><code>server@centos:~$ wget -q -O - https://updates.atomicorp.com/installers/atomic | sudo sh

For supported software packages please contact us at: 

  sales@atomicorp.com

Do you agree to these terms? (yes/no) [Default: yes] yes
Enable repo by default? (yes/no) [Default: yes]: yes
</code></pre></div><p>Enable PowerTools and install extra packages.</p> <div class="language- extra-class"><pre class="language-text"><code>server@centos:~$ sudo yum config-manager --set-enabled PowerTools
server@centos:~$ sudo yum install epel-release
</code></pre></div><p>Proceed and install GVM.</p> <div class="language- extra-class"><pre class="language-text"><code>server@centos:~$ sudo yum install gvm
</code></pre></div><p>Finally run the GVM configuration script to setup OpenVAS (this might take awhile).</p> <div class="language- extra-class"><pre class="language-text"><code>server@centos:~$ sudo gvm-setup
</code></pre></div><p>Once the GVM setup been complete proceed to set the administrator password.</p> <div class="custom-block warning"><p class="custom-block-title">NOTE</p> <p>Do not use special characters in the password.</p></div> <div class="language- extra-class"><div class="highlight-lines"><br><br><br><br><br><br><br><br><div class="highlighted"> </div><div class="highlighted"> </div><br><br><br><br></div><pre class="language-text"><code>Updating OpenVAS Manager certificates: Complete

GVMD startup: Done

Set the GSAD admin users password.
The admin user is used to configure accounts,
Update NVT's manually, and manage roles.

Enter Administrator Password:
Verify Administrator Password:

Setup complete
  Log in to GSAD at https://localhost
</code></pre></div><p>Login at your localhost e.g. <code>https://192.168.0.1</code> with the username <code>admin</code> and the chosen password.</p> <img src="/img/openvas/gsa_dashboard.png" alt="GSA dashboard" class="zoom-custom-imgs"> <h2 id="running-vulnerability-scans"><a href="#running-vulnerability-scans" class="header-anchor">#</a> Running vulnerability scans</h2> <p>There is several approaches on how to configure and run tasks (scans) toward your targets (hosts) in OpenVAS. In this tutorial we will go through how to run the more basic tasks. We will do both unauthenticated scans, where we do not grant OpenVAS SSH access to our target, and authenticated scans to help identify internal server vulnerabilites or misconfigurations.</p> <h3 id="unauthenticated-scan"><a href="#unauthenticated-scan" class="header-anchor">#</a> Unauthenticated scan</h3> <p><video controls="controls" preload="metadata"><source type="video/mp4" src="/vids/openvas/unauthenticated_scan.mp4">
Your browser does not support playing HTML5 video. You can <a href="/vids/openvas/unauthenticated_scan.mp4" download="">download a copy of the video file</a> instead.
Here is a description of the content: Unauthenticated scan
</video></p> <p>Login to the Greenbone Security Assistant (GSA) e.g. <code>https://192.168.0.1</code>. Once logged in we will add our first target. Go the the <em>Configuration</em> menu in the top navigation and select <em>Targets</em>.</p> <img src="/img/openvas/gsa_targets.png" alt="GSA targets" class="zoom-custom-imgs"> <p>In the top left corner of the <em>Targets</em> view there's a starred document icon, click and select to create a <em>New Target</em>. Fill in the name of the target server e.g. <em>Ubuntu Client</em> and its IP address <code>192.168.0.2</code>. Leave the rest of the settings in default.</p> <img src="/img/openvas/gsa_target.png" alt="GSA target" class="zoom-custom-imgs"> <p>Next we will create a task for unauthenticated targets (scans without SSH access). Go the <em>Scans</em> in the top menu and select <em>Tasks</em>.</p> <img src="/img/openvas/gsa_tasks.png" alt="GSA tasks" class="zoom-custom-imgs"> <p>Click the starred document icon in the top left corner of the <em>Tasks</em> view.</p> <img src="/img/openvas/gsa_task.png" alt="GSA task" class="zoom-custom-imgs"> <p>Select a descriptive name for your task e.g. Unauthenticated scan. In the <em>Scan Targets</em> dropdown menu select your target we created before (Ubuntu Client). Leave the default settings and click save.</p> <img src="/img/openvas/gsa_noauth_task.png" alt="GSA noauth task" class="zoom-custom-imgs"> <p>You will then be redirected back to the <em>Tasks</em> overview and our new task will be listed in the table below the graphs. To start the scan press the start button on the right side of the table.</p> <img src="/img/openvas/gsa_noauth_scan.png" alt="GSA noauth scan" class="zoom-custom-imgs"> <h3 id="authenticated-scan"><a href="#authenticated-scan" class="header-anchor">#</a> Authenticated scan</h3> <p>First make sure that you've generated SSH keys for your OpenVAS client user e.g. <code>client@ubuntu</code>. Add your public key to the targets authorized keys file. You may have to connect to your target host, through SSH, before running OpenVAS vulnerability scan to add the target host to your clients machine known hosts. Once you've established a secure communication between your client and target, proceed to configure credentials in the Greenbone Security Assistant. Go to <em>Configuration</em> and select <em>Credentials</em>.</p> <img src="/img/openvas/gsa_credentials.png" alt="GSA credentials" class="zoom-custom-imgs"> <p>Next click the starred document in the top left corner to create your new credentials. Give the credentials a desciptive name with an optional comment. In the dropdown menu <em>Type</em>, select <em>Username + SSH key</em> and disallow insecure use and auto-generation. Add the username of the target host user followed by the password and upload the private key (e.g. id_rsa). Click save.</p> <img src="/img/openvas/gsa_newcredentials.png" alt="GSA new credentials" class="zoom-custom-imgs"> <p>Go to the <em>Targets</em> section and either edit your <a href="#unauthenticated-scan">unauthenticated scan</a> or create a new target. Set the host IP address and in the dropdown menu, under the <em>Credentials for authentication checks</em>, select your newly created SSH credential.</p> <img src="/img/openvas/gsa_auth_target.png" alt="GSA auth target" class="zoom-custom-imgs"> <p>Finally create a new task and select the target that we attached our credentials to and leave the default settings.</p> <img src="/img/openvas/gsa_auth_task.png" alt="GSA auth task" class="zoom-custom-imgs"> <h2 id="install-openvas-9-community-version"><a href="#install-openvas-9-community-version" class="header-anchor">#</a> Install OpenVAS-9 community version <span class="badge warning" style="vertical-align:top;" data-v-15b7b770>deprecated</span></h2> <p>First add the OpenVAS PPA repository to your server.</p> <div class="language- extra-class"><pre class="language-text"><code>server@ubuntu:~$ sudo add-apt-repository ppa:mrazavi/openvas
</code></pre></div><p>Next we need to update and install the main packages.</p> <div class="language- extra-class"><pre class="language-text"><code>server@ubuntu:~$ sudo apt-get update
server@ubuntu:~$ sudo apt-get install openvas9
</code></pre></div><p>We will also install the OpenVAS9 dev package so we can run single OpenVAS nasl scripts, for fast troubleshooting. Additionaly we will also be adding the vulnerability data by syncing with the Greenbone feeds.</p> <div class="language- extra-class"><pre class="language-text"><code>server@ubuntu:~$ sudo apt-get install libopenvas9-dev
server@ubuntu:~$ sudo greenbone-nvt-sync
server@ubuntu:~$ sudo greenbone-scapdata-sync
server@ubuntu:~$ sudo greenbone-certdata-sync
</code></pre></div><p>To keep OpenVAS up-to-date to run the latest tests, we need to sync the nvt, scap and cert data regularly. To achieve this we will create a script and add it to our cron.</p> <div class="language- extra-class"><pre class="language-text"><code>server@ubuntu:~$ sudo nano /usr/local/bin/openvas-update
</code></pre></div><p>Add the following content to the openvas-update file.</p> <div class="language-bash extra-class"><pre class="language-bash"><code>/usr/sbin/greenbone-nvt-sync
/usr/sbin/greenbone-certdata-sync
/usr/sbin/greenbone-scapdata-sync
/usr/sbin/openvasmd --update --verbose --progress
/etc/init.d/openvas-manager restart
/etc/init.d/openvas-scanner restart
</code></pre></div><p>Save the file and make it executable.</p> <div class="language- extra-class"><pre class="language-text"><code>server@ubuntu:~$ sudo chmod a+x /usr/local/bin/openvas-update
</code></pre></div><p>We will add the update script to cron with a nightly frequency.</p> <div class="language- extra-class"><pre class="language-text"><code>Nightly 0 0 * * * root /usr/local/bin/openvas-update
</code></pre></div><h2 id="openvas-behind-nginx-proxy"><a href="#openvas-behind-nginx-proxy" class="header-anchor">#</a> OpenVAS behind NGINX Proxy</h2> <div class="language- extra-class"><pre class="language-text"><code>server@ubuntu:~$ sudo nano /etc/default/openvas-gsa
</code></pre></div><div class="language-bash extra-class"><pre class="language-bash"><code><span class="token comment"># Defaults for Greenbone Security Assistant initscript</span>
<span class="token comment"># sourced by /etc/init.d/openvas-gsa</span>
<span class="token comment"># installed at /etc/default/openvas-gsa by the maintainer scripts</span>

<span class="token comment"># To disable HTTPS:</span>
<span class="token comment">#</span>
<span class="token comment">#HTTP_ONLY=1</span>

<span class="token comment"># To allow &lt;host&gt; as hostname/address part of a Host header:</span>
<span class="token comment">#</span>
<span class="token assign-left variable">ALLOW_HEADER_HOST</span><span class="token operator">=</span>openvas.example.com

<span class="token comment"># To enable http redirection:</span>
<span class="token comment">#</span>
<span class="token assign-left variable">HTTP_REDIRECT</span><span class="token operator">=</span><span class="token number">1</span>

<span class="token comment"># To set listening address:</span>
<span class="token comment">#</span>
<span class="token assign-left variable">LISTEN_ADDRESS</span><span class="token operator">=</span><span class="token string">&quot;127.0.0.1&quot;</span>

<span class="token comment"># To set listening port number:</span>
<span class="token comment">#</span>
<span class="token assign-left variable">PORT_NUMBER</span><span class="token operator">=</span><span class="token number">4000</span>
</code></pre></div><p>Restart openvas-gsa <code>sudo systemctl restart openvas-gsa</code>. Edit the NGINX configuration to fit the environment.</p> <div class="language-nginx extra-class"><pre class="language-nginx"><code><span class="token keyword">server</span> <span class="token punctuation">{</span>
    <span class="token keyword">listen</span> <span class="token number">443</span> <span class="token keyword">ssl</span> http2<span class="token punctuation">;</span>
    <span class="token keyword">listen</span> <span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token punctuation">:</span><span class="token number">443</span> <span class="token keyword">ssl</span> http2<span class="token punctuation">;</span>
    <span class="token keyword">server_name</span> openvas<span class="token punctuation">.</span>example<span class="token punctuation">.</span>com<span class="token punctuation">;</span>

    <span class="token comment"># SSL CERTIFICATES</span>
    <span class="token keyword">ssl_certificate</span> <span class="token operator">/</span>etc<span class="token operator">/</span>nginx<span class="token operator">/</span><span class="token keyword">ssl</span><span class="token operator">/</span>openvas<span class="token punctuation">.</span>example<span class="token punctuation">.</span>com<span class="token operator">/</span><span class="token keyword">server</span><span class="token punctuation">.</span>crt<span class="token punctuation">;</span>
    <span class="token keyword">ssl_certificate_key</span> <span class="token operator">/</span>etc<span class="token operator">/</span>nginx<span class="token operator">/</span><span class="token keyword">ssl</span><span class="token operator">/</span>openvas<span class="token punctuation">.</span>example<span class="token punctuation">.</span>com<span class="token operator">/</span><span class="token keyword">server</span><span class="token punctuation">.</span>key<span class="token punctuation">;</span>

    <span class="token keyword">ssl_protocols</span> TLSv1<span class="token punctuation">.</span><span class="token number">2</span><span class="token punctuation">;</span>
    <span class="token keyword">ssl_ciphers</span> ECDHE<span class="token operator">-</span>RSA<span class="token operator">-</span>AES256<span class="token operator">-</span>GCM<span class="token operator">-</span>SHA512<span class="token punctuation">:</span>DHE<span class="token operator">-</span>RSA<span class="token operator">-</span>AES256<span class="token operator">-</span>GCM<span class="token operator">-</span>SHA512<span class="token punctuation">:</span>ECDHE<span class="token operator">-</span>RSA<span class="token operator">-</span>AES256<span class="token operator">-</span>GCM<span class="token operator">-</span>SHA384<span class="token punctuation">:</span>DHE<span class="token operator">-</span>RSA<span class="token operator">-</span>AES256<span class="token operator">-</span>GCM<span class="token operator">-</span>SHA384<span class="token punctuation">:</span>ECDHE<span class="token operator">-</span>RSA<span class="token operator">-</span>AES256<span class="token operator">-</span>SHA384<span class="token punctuation">;</span>
    <span class="token keyword">ssl_prefer_server_ciphers</span> on<span class="token punctuation">;</span>
    <span class="token keyword">ssl_dhparam</span> <span class="token operator">/</span>etc<span class="token operator">/</span>nginx<span class="token operator">/</span>dhparams<span class="token punctuation">.</span>pem<span class="token punctuation">;</span>

    <span class="token keyword">add_header</span> X<span class="token operator">-</span>Frame<span class="token operator">-</span>Options <span class="token string">&quot;SAMEORIGIN&quot;</span><span class="token punctuation">;</span>
    <span class="token keyword">add_header</span> X<span class="token operator">-</span>XSS<span class="token operator">-</span>Protection <span class="token string">&quot;1; mode=block&quot;</span><span class="token punctuation">;</span>
    <span class="token keyword">add_header</span> X<span class="token operator">-</span>Content<span class="token operator">-</span>Type<span class="token operator">-</span>Options <span class="token string">&quot;nosniff&quot;</span><span class="token punctuation">;</span>

    <span class="token keyword">index</span> <span class="token keyword">index</span><span class="token punctuation">.</span>html <span class="token keyword">index</span><span class="token punctuation">.</span>htm <span class="token keyword">index</span><span class="token punctuation">.</span>php<span class="token punctuation">;</span>

    <span class="token keyword">charset</span> utf<span class="token operator">-</span><span class="token number">8</span><span class="token punctuation">;</span>

    <span class="token keyword">location</span> <span class="token operator">/</span> <span class="token punctuation">{</span>
        <span class="token keyword">proxy_set_header</span>   Host             <span class="token variable">$http_host</span><span class="token punctuation">;</span>
        <span class="token keyword">proxy_set_header</span>   X<span class="token operator">-</span>Real<span class="token operator">-</span>IP        <span class="token variable">$remote_addr</span><span class="token punctuation">;</span>
        <span class="token keyword">proxy_set_header</span>   REMOTE_HOST      <span class="token variable">$remote_addr</span><span class="token punctuation">;</span>
        <span class="token keyword">proxy_set_header</span>   X<span class="token operator">-</span>Forwarded<span class="token operator">-</span>For  <span class="token variable">$proxy_add_x_forwarded_for</span><span class="token punctuation">;</span>
        <span class="token keyword">proxy_set_header</span>   X<span class="token operator">-</span>FORWARDED<span class="token operator">-</span><span class="token keyword">PROTOCOL</span> <span class="token variable">$scheme</span><span class="token punctuation">;</span>  
        <span class="token keyword">proxy_pass</span> <span class="token keyword">https</span><span class="token punctuation">:</span><span class="token operator">/</span><span class="token operator">/</span><span class="token number">127.0</span><span class="token number">.0</span><span class="token number">.1</span><span class="token punctuation">:</span><span class="token number">4000</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

   <span class="token keyword">location</span> <span class="token operator">=</span> <span class="token operator">/</span>favicon<span class="token punctuation">.</span>ico <span class="token punctuation">{</span> <span class="token keyword">access_log</span> off<span class="token punctuation">;</span> <span class="token keyword">log_not_found</span> off<span class="token punctuation">;</span> <span class="token punctuation">}</span>
   <span class="token keyword">location</span> <span class="token operator">=</span> <span class="token operator">/</span>robots<span class="token punctuation">.</span>txt  <span class="token punctuation">{</span> <span class="token keyword">access_log</span> off<span class="token punctuation">;</span> <span class="token keyword">log_not_found</span> off<span class="token punctuation">;</span> <span class="token punctuation">}</span>

   <span class="token keyword">access_log</span> off<span class="token punctuation">;</span>
   <span class="token keyword">error_log</span>  <span class="token operator">/</span>var<span class="token operator">/</span>log<span class="token operator">/</span>nginx<span class="token operator">/</span>openvas<span class="token punctuation">.</span>example<span class="token punctuation">.</span>com<span class="token operator">-</span>error<span class="token punctuation">.</span>log error<span class="token punctuation">;</span>

   <span class="token keyword">location</span> <span class="token operator">~</span> <span class="token operator">/</span>\<span class="token punctuation">.</span><span class="token punctuation">(</span><span class="token operator">?</span><span class="token operator">!</span>well<span class="token operator">-</span>known<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token operator">*</span> <span class="token punctuation">{</span>
       <span class="token keyword">deny</span> all<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><div class="language- extra-class"><pre class="language-text"><code>server@ubuntu:~$ sudo systemctl reload nginx.service
</code></pre></div><h2 id="scheduled-jobs"><a href="#scheduled-jobs" class="header-anchor">#</a> Scheduled jobs</h2> <p>To keep the community feed up-to-date, first login as your gvm user.</p> <div class="language- extra-class"><pre class="language-text"><code>server@ubuntu:~$ sudo su - gvm
</code></pre></div><p>Create the file that we will populate with the required commands.</p> <div class="language- extra-class"><pre class="language-text"><code>gvm@ubuntu:~$ touch /opt/gvm/bin/openvas-update
</code></pre></div><p>Make the file executable.</p> <div class="language- extra-class"><pre class="language-text"><code>gvm@ubuntu:~$ chmod a+x /opt/gvm/bin/openvas-update
</code></pre></div><p>Enter the commands that we will run daily.</p> <div class="language- extra-class"><pre class="language-text"><code>gvm@ubuntu:~$ nano /opt/gvm/bin/openvas-update
</code></pre></div><div class="language- extra-class"><pre class="language-text"><code>/opt/gvm/bin/greenbone-nvt-sync
/opt/gvm/sbin/greenbone-feed-sync --type GVMD_DATA
/opt/gvm/sbin/greenbone-feed-sync --type SCAP
/opt/gvm/sbin/greenbone-feed-sync --type CERT
</code></pre></div><p>Edit the GVM users crontab and add the script we created to check for daily updates.</p> <div class="language- extra-class"><pre class="language-text"><code>gvm@ubuntu:~$ crontab -e
</code></pre></div><div class="language-bash extra-class"><div class="highlight-lines"><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><div class="highlighted"> </div><br></div><pre class="language-bash"><code><span class="token comment"># Edit this file to introduce tasks to be run by cron.</span>
<span class="token comment">#</span>
<span class="token comment"># Each task to run has to be defined through a single line</span>
<span class="token comment"># indicating with different fields when the task will be run</span>
<span class="token comment"># and what command to run for the task</span>
<span class="token comment">#</span>
<span class="token comment"># To define the time you can provide concrete values for</span>
<span class="token comment"># minute (m), hour (h), day of month (dom), month (mon),</span>
<span class="token comment"># and day of week (dow) or use '*' in these fields (for 'any').</span>
<span class="token comment">#</span>
<span class="token comment"># Notice that tasks will be started based on the cron's system</span>
<span class="token comment"># daemon's notion of time and timezones.</span>
<span class="token comment">#</span>
<span class="token comment"># Output of the crontab jobs (including errors) is sent through</span>
<span class="token comment"># email to the user the crontab file belongs to (unless redirected).</span>
<span class="token comment">#</span>
<span class="token comment"># For example, you can run a backup of all your user accounts</span>
<span class="token comment"># at 5 a.m every week with:</span>
<span class="token comment"># 0 5 * * 1 tar -zcf /var/backups/home.tgz /home/</span>
<span class="token comment">#</span>
<span class="token comment"># For more information see the manual pages of crontab(5) and cron(8)</span>
<span class="token comment">#</span>
<span class="token comment"># m h  dom mon dow   command</span>

<span class="token number">0</span> <span class="token number">0</span> * * * /opt/gvm/bin/openvas-update
</code></pre></div><h2 id="troubleshooting"><a href="#troubleshooting" class="header-anchor">#</a> Troubleshooting</h2> <p>If you encounter any issue or having questions regarding OpenVAS I recommend using their very helpful <a href="https://community.greenbone.net/" target="_blank" rel="noopener noreferrer">community forum<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>.</p> <p><a href="https://github.com/libellux/Libellux-Up-and-Running/issues/new/choose" target="_blank" rel="noopener noreferrer">Questions<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>, <a href="https://github.com/libellux/Libellux-Up-and-Running/issues/new/choose" target="_blank" rel="noopener noreferrer">comments<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>, or <a href="https://github.com/libellux/Libellux-Up-and-Running/issues/new/choose" target="_blank" rel="noopener noreferrer">problems<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> regarding this service? Create an issue <a href="https://github.com/libellux/Libellux-Up-and-Running/issues/new/choose" target="_blank" rel="noopener noreferrer">here<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> or contact <a href="mailto:webmaster@libellux.com">webmaster@libellux.com</a>.</p> <h3 id="sec-error-inadequate-key-usage"><a href="#sec-error-inadequate-key-usage" class="header-anchor">#</a> SEC_ERROR_INADEQUATE_KEY_USAGE</h3> <p>If receiving <code>SEC_ERROR_INADEQUATE_KEY_USAGE</code> and the browser blocks access to the local GVM server, proceed with removing the certificate. For example, in Firefox go to <code>about:preferences#privacy</code> and the certificate section. Select Show certificates, click the Servers tab and remove the certificates found under GVM Users.</p> <h3 id="failed-to-find-interpreter-for-python-3-7"><a href="#failed-to-find-interpreter-for-python-3-7" class="header-anchor">#</a> Failed to find interpreter for Python 3.7</h3> <p>If receiving <code>RuntimeError: failed to find interpreter for Builtin discover of python_spec='python3.7'</code> make sure you've followed the instructions to install the required 3.7 packages.</p> <div class="language- extra-class"><pre class="language-text"><code>server@ubuntu:~$ sudo add-apt-repository ppa:deadsnakes/ppa
server@ubuntu:~$ sudo apt-get update
server@ubuntu:~$ sudo apt-get install python3.7 python3.7-dev
</code></pre></div><h2 id="enterprise-solutions"><a href="#enterprise-solutions" class="header-anchor">#</a> Enterprise solutions <span class="badge default" style="vertical-align:top;" data-v-15b7b770>non-sponsored</span></h2> <h3 id="the-greenbone-security-manager"><a href="#the-greenbone-security-manager" class="header-anchor">#</a> The Greenbone Security Manager</h3> <p>The Greenbone Security Manager (GSM) is an appliance for vulnerability scanning and management. It is offered in various performance levels and basically supports an unlimited number of target systems. The actually achievable number depends on the scan pattern and scan targets. For finding the right model for your purpose, we provide reference values for the number of target IP addresses below, assuming a common scenario with a scan every 24 hours.</p> <p><a href="https://www.greenbone.net/en/product-comparison/" target="_blank" rel="noopener noreferrer">Greenbone Security Manager<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p><a href="https://ko-fi.com/B0B31BJU3" target="_blank" rel="noopener noreferrer"><img src="https://www.ko-fi.com/img/githubbutton_sm.svg" alt="ko-fi"><span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <!----></div> <footer class="page-edit"><div class="edit-link"><a href="https://github.com/libellux/Libellux-Up-and-Running/edit/master/docs/openvas/README.md" target="_blank" rel="noopener noreferrer">Edit this page</a> <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></div> <div class="last-updated"><span class="prefix">Last Updated:</span> <span class="time">12/19/2020, 12:01:46 AM</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/psad/" class="prev">
        PSAD Intrusion Detection
      </a></span> <span class="next"><a href="/mmonit/">
        M/Monit System Monitoring
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"><!----><!----><!----></div></div>
    <script src="/assets/js/app.233fab16.js" defer></script><script src="/assets/js/2.e28a458f.js" defer></script><script src="/assets/js/16.fa8634a1.js" defer></script><script src="/assets/js/7.11d40bb1.js" defer></script><script src="/assets/js/4.197bc1c7.js" defer></script><script src="/assets/js/3.1f33fffe.js" defer></script>
  </body>
</html>
